{"ast":null,"code":"\"use strict\";\n\nvar _object = _interopRequireDefault(require(\"object.assign\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _reactDom = _interopRequireDefault(require(\"react-dom\"));\n\nvar _server = _interopRequireDefault(require(\"react-dom/server\"));\n\nvar _shallow = _interopRequireDefault(require(\"react-test-renderer/shallow\"));\n\nvar _package = require(\"react-test-renderer/package.json\");\n\nvar _testUtils = _interopRequireDefault(require(\"react-dom/test-utils\"));\n\nvar _semver = _interopRequireDefault(require(\"semver\"));\n\nvar _checkPropTypes2 = _interopRequireDefault(require(\"prop-types/checkPropTypes\"));\n\nvar _has = _interopRequireDefault(require(\"has\"));\n\nvar _reactIs = require(\"react-is\");\n\nvar _enzyme = require(\"enzyme\");\n\nvar _Utils = require(\"enzyme/build/Utils\");\n\nvar _enzymeShallowEqual = _interopRequireDefault(require(\"enzyme-shallow-equal\"));\n\nvar _enzymeAdapterUtils = require(\"enzyme-adapter-utils\");\n\nvar _findCurrentFiberUsingSlowPath = _interopRequireDefault(require(\"./findCurrentFiberUsingSlowPath\"));\n\nvar _detectFiberTags = _interopRequireDefault(require(\"./detectFiberTags\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar is164 = !!_testUtils[\"default\"].Simulate.touchStart; // 16.4+\n\nvar is165 = !!_testUtils[\"default\"].Simulate.auxClick; // 16.5+\n\nvar is166 = is165 && !_react[\"default\"].unstable_AsyncMode; // 16.6+\n\nvar is168 = is166 && typeof _testUtils[\"default\"].act === 'function';\n\nvar hasShouldComponentUpdateBug = _semver[\"default\"].satisfies(_package.version, '< 16.8'); // Lazily populated if DOM is available.\n\n\nvar FiberTags = null;\n\nfunction nodeAndSiblingsArray(nodeWithSibling) {\n  var array = [];\n  var node = nodeWithSibling;\n\n  while (node != null) {\n    array.push(node);\n    node = node.sibling;\n  }\n\n  return array;\n}\n\nfunction flatten(arr) {\n  var result = [];\n  var stack = [{\n    i: 0,\n    array: arr\n  }];\n\n  while (stack.length) {\n    var n = stack.pop();\n\n    while (n.i < n.array.length) {\n      var el = n.array[n.i];\n      n.i += 1;\n\n      if (Array.isArray(el)) {\n        stack.push(n);\n        stack.push({\n          i: 0,\n          array: el\n        });\n        break;\n      }\n\n      result.push(el);\n    }\n  }\n\n  return result;\n}\n\nfunction nodeTypeFromType(type) {\n  if (type === _reactIs.Portal) {\n    return 'portal';\n  }\n\n  return (0, _enzymeAdapterUtils.nodeTypeFromType)(type);\n}\n\nfunction isMemo(type) {\n  return (0, _enzymeAdapterUtils.compareNodeTypeOf)(type, _reactIs.Memo);\n}\n\nfunction isLazy(type) {\n  return (0, _enzymeAdapterUtils.compareNodeTypeOf)(type, _reactIs.Lazy);\n}\n\nfunction unmemoType(type) {\n  return isMemo(type) ? type.type : type;\n}\n\nfunction transformSuspense(renderedEl, prerenderEl, _ref) {\n  var suspenseFallback = _ref.suspenseFallback;\n\n  if (!(0, _reactIs.isSuspense)(renderedEl)) {\n    return renderedEl;\n  }\n\n  var children = renderedEl.props.children;\n\n  if (suspenseFallback) {\n    var fallback = renderedEl.props.fallback;\n    children = replaceLazyWithFallback(children, fallback);\n  }\n\n  var _renderedEl$type = renderedEl.type,\n      propTypes = _renderedEl$type.propTypes,\n      defaultProps = _renderedEl$type.defaultProps,\n      contextTypes = _renderedEl$type.contextTypes,\n      contextType = _renderedEl$type.contextType,\n      childContextTypes = _renderedEl$type.childContextTypes;\n  var FakeSuspense = (0, _object[\"default\"])(isStateful(prerenderEl.type) ? /*#__PURE__*/function (_prerenderEl$type) {\n    _inherits(FakeSuspense, _prerenderEl$type);\n\n    var _super = _createSuper(FakeSuspense);\n\n    function FakeSuspense() {\n      _classCallCheck(this, FakeSuspense);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(FakeSuspense, [{\n      key: \"render\",\n      value: function render() {\n        var type = prerenderEl.type,\n            props = prerenderEl.props;\n        return /*#__PURE__*/_react[\"default\"].createElement(type, _objectSpread(_objectSpread({}, props), this.props), children);\n      }\n    }]);\n\n    return FakeSuspense;\n  }(prerenderEl.type) : function FakeSuspense(props) {\n    // eslint-disable-line prefer-arrow-callback\n    return /*#__PURE__*/_react[\"default\"].createElement(renderedEl.type, _objectSpread(_objectSpread({}, renderedEl.props), props), children);\n  }, {\n    propTypes: propTypes,\n    defaultProps: defaultProps,\n    contextTypes: contextTypes,\n    contextType: contextType,\n    childContextTypes: childContextTypes\n  });\n  return /*#__PURE__*/_react[\"default\"].createElement(FakeSuspense, null, children);\n}\n\nfunction elementToTree(el) {\n  if (!(0, _reactIs.isPortal)(el)) {\n    return (0, _enzymeAdapterUtils.elementToTree)(el, elementToTree);\n  }\n\n  var children = el.children,\n      containerInfo = el.containerInfo;\n  var props = {\n    children: children,\n    containerInfo: containerInfo\n  };\n  return {\n    nodeType: 'portal',\n    type: _reactIs.Portal,\n    props: props,\n    key: (0, _enzymeAdapterUtils.ensureKeyOrUndefined)(el.key),\n    ref: el.ref || null,\n    instance: null,\n    rendered: elementToTree(el.children)\n  };\n}\n\nfunction _toTree(vnode) {\n  if (vnode == null) {\n    return null;\n  } // TODO(lmr): I'm not really sure I understand whether or not this is what\n  // i should be doing, or if this is a hack for something i'm doing wrong\n  // somewhere else. Should talk to sebastian about this perhaps\n\n\n  var node = (0, _findCurrentFiberUsingSlowPath[\"default\"])(vnode);\n\n  switch (node.tag) {\n    case FiberTags.HostRoot:\n      return childrenToTree(node.child);\n\n    case FiberTags.HostPortal:\n      {\n        var containerInfo = node.stateNode.containerInfo,\n            children = node.memoizedProps;\n        var props = {\n          containerInfo: containerInfo,\n          children: children\n        };\n        return {\n          nodeType: 'portal',\n          type: _reactIs.Portal,\n          props: props,\n          key: (0, _enzymeAdapterUtils.ensureKeyOrUndefined)(node.key),\n          ref: node.ref,\n          instance: null,\n          rendered: childrenToTree(node.child)\n        };\n      }\n\n    case FiberTags.ClassComponent:\n      return {\n        nodeType: 'class',\n        type: node.type,\n        props: _objectSpread({}, node.memoizedProps),\n        key: (0, _enzymeAdapterUtils.ensureKeyOrUndefined)(node.key),\n        ref: node.ref,\n        instance: node.stateNode,\n        rendered: childrenToTree(node.child)\n      };\n\n    case FiberTags.FunctionalComponent:\n      return {\n        nodeType: 'function',\n        type: node.type,\n        props: _objectSpread({}, node.memoizedProps),\n        key: (0, _enzymeAdapterUtils.ensureKeyOrUndefined)(node.key),\n        ref: node.ref,\n        instance: null,\n        rendered: childrenToTree(node.child)\n      };\n\n    case FiberTags.MemoClass:\n      return {\n        nodeType: 'class',\n        type: node.elementType.type,\n        props: _objectSpread({}, node.memoizedProps),\n        key: (0, _enzymeAdapterUtils.ensureKeyOrUndefined)(node.key),\n        ref: node.ref,\n        instance: node.stateNode,\n        rendered: childrenToTree(node.child.child)\n      };\n\n    case FiberTags.MemoSFC:\n      {\n        var renderedNodes = flatten(nodeAndSiblingsArray(node.child).map(_toTree));\n\n        if (renderedNodes.length === 0) {\n          renderedNodes = [node.memoizedProps.children];\n        }\n\n        return {\n          nodeType: 'function',\n          type: node.elementType,\n          props: _objectSpread({}, node.memoizedProps),\n          key: (0, _enzymeAdapterUtils.ensureKeyOrUndefined)(node.key),\n          ref: node.ref,\n          instance: null,\n          rendered: renderedNodes\n        };\n      }\n\n    case FiberTags.HostComponent:\n      {\n        var _renderedNodes = flatten(nodeAndSiblingsArray(node.child).map(_toTree));\n\n        if (_renderedNodes.length === 0) {\n          _renderedNodes = [node.memoizedProps.children];\n        }\n\n        return {\n          nodeType: 'host',\n          type: node.type,\n          props: _objectSpread({}, node.memoizedProps),\n          key: (0, _enzymeAdapterUtils.ensureKeyOrUndefined)(node.key),\n          ref: node.ref,\n          instance: node.stateNode,\n          rendered: _renderedNodes\n        };\n      }\n\n    case FiberTags.HostText:\n      return node.memoizedProps;\n\n    case FiberTags.Fragment:\n    case FiberTags.Mode:\n    case FiberTags.ContextProvider:\n    case FiberTags.ContextConsumer:\n      return childrenToTree(node.child);\n\n    case FiberTags.Profiler:\n    case FiberTags.ForwardRef:\n      {\n        return {\n          nodeType: 'function',\n          type: node.type,\n          props: _objectSpread({}, node.pendingProps),\n          key: (0, _enzymeAdapterUtils.ensureKeyOrUndefined)(node.key),\n          ref: node.ref,\n          instance: null,\n          rendered: childrenToTree(node.child)\n        };\n      }\n\n    case FiberTags.Suspense:\n      {\n        return {\n          nodeType: 'function',\n          type: _reactIs.Suspense,\n          props: _objectSpread({}, node.memoizedProps),\n          key: (0, _enzymeAdapterUtils.ensureKeyOrUndefined)(node.key),\n          ref: node.ref,\n          instance: null,\n          rendered: childrenToTree(node.child)\n        };\n      }\n\n    case FiberTags.Lazy:\n      return childrenToTree(node.child);\n\n    default:\n      throw new Error(\"Enzyme Internal Error: unknown node with tag \".concat(node.tag));\n  }\n}\n\nfunction childrenToTree(node) {\n  if (!node) {\n    return null;\n  }\n\n  var children = nodeAndSiblingsArray(node);\n\n  if (children.length === 0) {\n    return null;\n  }\n\n  if (children.length === 1) {\n    return _toTree(children[0]);\n  }\n\n  return flatten(children.map(_toTree));\n}\n\nfunction _nodeToHostNode(_node) {\n  // NOTE(lmr): node could be a function component\n  // which wont have an instance prop, but we can get the\n  // host node associated with its return value at that point.\n  // Although this breaks down if the return value is an array,\n  // as is possible with React 16.\n  var node = _node;\n\n  while (node && !Array.isArray(node) && node.instance === null) {\n    node = node.rendered;\n  } // if the SFC returned null effectively, there is no host node.\n\n\n  if (!node) {\n    return null;\n  }\n\n  var mapper = function mapper(item) {\n    if (item && item.instance) return _reactDom[\"default\"].findDOMNode(item.instance);\n    return null;\n  };\n\n  if (Array.isArray(node)) {\n    return node.map(mapper);\n  }\n\n  if (Array.isArray(node.rendered) && node.nodeType === 'class') {\n    return node.rendered.map(mapper);\n  }\n\n  return mapper(node);\n}\n\nfunction replaceLazyWithFallback(node, fallback) {\n  if (!node) {\n    return null;\n  }\n\n  if (Array.isArray(node)) {\n    return node.map(function (el) {\n      return replaceLazyWithFallback(el, fallback);\n    });\n  }\n\n  if (isLazy(node.type)) {\n    return fallback;\n  }\n\n  return _objectSpread(_objectSpread({}, node), {}, {\n    props: _objectSpread(_objectSpread({}, node.props), {}, {\n      children: replaceLazyWithFallback(node.props.children, fallback)\n    })\n  });\n}\n\nvar eventOptions = {\n  animation: true,\n  pointerEvents: is164,\n  auxClick: is165\n};\n\nfunction getEmptyStateValue() {\n  // this handles a bug in React 16.0 - 16.2\n  // see https://github.com/facebook/react/commit/39be83565c65f9c522150e52375167568a2a1459\n  // also see https://github.com/facebook/react/pull/11965\n  // eslint-disable-next-line react/prefer-stateless-function\n  var EmptyState = /*#__PURE__*/function (_React$Component) {\n    _inherits(EmptyState, _React$Component);\n\n    var _super2 = _createSuper(EmptyState);\n\n    function EmptyState() {\n      _classCallCheck(this, EmptyState);\n\n      return _super2.apply(this, arguments);\n    }\n\n    _createClass(EmptyState, [{\n      key: \"render\",\n      value: function render() {\n        return null;\n      }\n    }]);\n\n    return EmptyState;\n  }(_react[\"default\"].Component);\n\n  var testRenderer = new _shallow[\"default\"]();\n  testRenderer.render( /*#__PURE__*/_react[\"default\"].createElement(EmptyState));\n  return testRenderer._instance.state;\n}\n\nfunction wrapAct(fn) {\n  if (!is168) {\n    return fn();\n  }\n\n  var returnVal;\n\n  _testUtils[\"default\"].act(function () {\n    returnVal = fn();\n  });\n\n  return returnVal;\n}\n\nfunction getProviderDefaultValue(Provider) {\n  // React stores references to the Provider's defaultValue differently across versions.\n  if ('_defaultValue' in Provider._context) {\n    return Provider._context._defaultValue;\n  }\n\n  if ('_currentValue' in Provider._context) {\n    return Provider._context._currentValue;\n  }\n\n  throw new Error('Enzyme Internal Error: can’t figure out how to get Provider’s default value');\n}\n\nfunction makeFakeElement(type) {\n  return {\n    $$typeof: _reactIs.Element,\n    type: type\n  };\n}\n\nfunction isStateful(Component) {\n  return Component.prototype && (Component.prototype.isReactComponent || Array.isArray(Component.__reactAutoBindPairs) // fallback for createClass components\n  );\n}\n\nvar ReactSixteenAdapter = /*#__PURE__*/function (_EnzymeAdapter) {\n  _inherits(ReactSixteenAdapter, _EnzymeAdapter);\n\n  var _super3 = _createSuper(ReactSixteenAdapter);\n\n  function ReactSixteenAdapter() {\n    var _this;\n\n    _classCallCheck(this, ReactSixteenAdapter);\n\n    _this = _super3.call(this);\n    var lifecycles = _this.options.lifecycles;\n    _this.options = _objectSpread(_objectSpread({}, _this.options), {}, {\n      enableComponentDidUpdateOnSetState: true,\n      // TODO: remove, semver-major\n      legacyContextMode: 'parent',\n      lifecycles: _objectSpread(_objectSpread({}, lifecycles), {}, {\n        componentDidUpdate: {\n          onSetState: true\n        },\n        getDerivedStateFromProps: {\n          hasShouldComponentUpdateBug: hasShouldComponentUpdateBug\n        },\n        getSnapshotBeforeUpdate: true,\n        setState: {\n          skipsComponentDidUpdateOnNullish: true\n        },\n        getChildContext: {\n          calledByRenderer: false\n        },\n        getDerivedStateFromError: is166\n      })\n    });\n    return _this;\n  }\n\n  _createClass(ReactSixteenAdapter, [{\n    key: \"createMountRenderer\",\n    value: function createMountRenderer(options) {\n      (0, _enzymeAdapterUtils.assertDomAvailable)('mount');\n\n      if ((0, _has[\"default\"])(options, 'suspenseFallback')) {\n        throw new TypeError('`suspenseFallback` is not supported by the `mount` renderer');\n      }\n\n      if (FiberTags === null) {\n        // Requires DOM.\n        FiberTags = (0, _detectFiberTags[\"default\"])();\n      }\n\n      var attachTo = options.attachTo,\n          hydrateIn = options.hydrateIn,\n          wrappingComponentProps = options.wrappingComponentProps;\n      var domNode = hydrateIn || attachTo || global.document.createElement('div');\n      var instance = null;\n      var adapter = this;\n      return _objectSpread({\n        render: function render(el, context, callback) {\n          return wrapAct(function () {\n            if (instance === null) {\n              var type = el.type,\n                  props = el.props,\n                  ref = el.ref;\n\n              var wrapperProps = _objectSpread({\n                Component: type,\n                props: props,\n                wrappingComponentProps: wrappingComponentProps,\n                context: context\n              }, ref && {\n                refProp: ref\n              });\n\n              var ReactWrapperComponent = (0, _enzymeAdapterUtils.createMountWrapper)(el, _objectSpread(_objectSpread({}, options), {}, {\n                adapter: adapter\n              }));\n\n              var wrappedEl = /*#__PURE__*/_react[\"default\"].createElement(ReactWrapperComponent, wrapperProps);\n\n              instance = hydrateIn ? _reactDom[\"default\"].hydrate(wrappedEl, domNode) : _reactDom[\"default\"].render(wrappedEl, domNode);\n\n              if (typeof callback === 'function') {\n                callback();\n              }\n            } else {\n              instance.setChildProps(el.props, context, callback);\n            }\n          });\n        },\n        unmount: function unmount() {\n          _reactDom[\"default\"].unmountComponentAtNode(domNode);\n\n          instance = null;\n        },\n        getNode: function getNode() {\n          if (!instance) {\n            return null;\n          }\n\n          return (0, _enzymeAdapterUtils.getNodeFromRootFinder)(adapter.isCustomComponent, _toTree(instance._reactInternalFiber), options);\n        },\n        simulateError: function simulateError(nodeHierarchy, rootNode, error) {\n          var isErrorBoundary = function isErrorBoundary(_ref2) {\n            var elInstance = _ref2.instance,\n                type = _ref2.type;\n\n            if (is166 && type && type.getDerivedStateFromError) {\n              return true;\n            }\n\n            return elInstance && elInstance.componentDidCatch;\n          };\n\n          var _ref3 = nodeHierarchy.find(isErrorBoundary) || {},\n              catchingInstance = _ref3.instance,\n              catchingType = _ref3.type;\n\n          (0, _enzymeAdapterUtils.simulateError)(error, catchingInstance, rootNode, nodeHierarchy, nodeTypeFromType, adapter.displayNameOfNode, is166 ? catchingType : undefined);\n        },\n        simulateEvent: function simulateEvent(node, event, mock) {\n          var mappedEvent = (0, _enzymeAdapterUtils.mapNativeEventNames)(event, eventOptions);\n          var eventFn = _testUtils[\"default\"].Simulate[mappedEvent];\n\n          if (!eventFn) {\n            throw new TypeError(\"ReactWrapper::simulate() event '\".concat(event, \"' does not exist\"));\n          }\n\n          wrapAct(function () {\n            eventFn(adapter.nodeToHostNode(node), mock);\n          });\n        },\n        batchedUpdates: function batchedUpdates(fn) {\n          return fn(); // return ReactDOM.unstable_batchedUpdates(fn);\n        },\n        getWrappingComponentRenderer: function getWrappingComponentRenderer() {\n          return _objectSpread(_objectSpread({}, this), (0, _enzymeAdapterUtils.getWrappingComponentMountRenderer)({\n            toTree: function toTree(inst) {\n              return _toTree(inst._reactInternalFiber);\n            },\n            getMountWrapperInstance: function getMountWrapperInstance() {\n              return instance;\n            }\n          }));\n        }\n      }, is168 && {\n        wrapInvoke: wrapAct\n      });\n    }\n  }, {\n    key: \"createShallowRenderer\",\n    value: function createShallowRenderer() {\n      var _this2 = this;\n\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var adapter = this;\n      var renderer = new _shallow[\"default\"]();\n      var suspenseFallback = options.suspenseFallback;\n\n      if (typeof suspenseFallback !== 'undefined' && typeof suspenseFallback !== 'boolean') {\n        throw TypeError('`options.suspenseFallback` should be boolean or undefined');\n      }\n\n      var isDOM = false;\n      var cachedNode = null;\n      var lastComponent = null;\n      var wrappedComponent = null;\n      var sentinel = {}; // wrap memo components with a PureComponent, or a class component with sCU\n\n      var wrapPureComponent = function wrapPureComponent(Component, compare) {\n        if (!is166) {\n          throw new RangeError('this function should not be called in React < 16.6. Please report this!');\n        }\n\n        if (lastComponent !== Component) {\n          if (isStateful(Component)) {\n            wrappedComponent = /*#__PURE__*/function (_Component) {\n              _inherits(wrappedComponent, _Component);\n\n              var _super4 = _createSuper(wrappedComponent);\n\n              function wrappedComponent() {\n                _classCallCheck(this, wrappedComponent);\n\n                return _super4.apply(this, arguments);\n              }\n\n              return wrappedComponent;\n            }(Component); // eslint-disable-line react/prefer-stateless-function\n\n\n            if (compare) {\n              wrappedComponent.prototype.shouldComponentUpdate = function (nextProps) {\n                return !compare(_this2.props, nextProps);\n              };\n            } else {\n              wrappedComponent.prototype.isPureReactComponent = true;\n            }\n          } else {\n            var memoized = sentinel;\n            var prevProps;\n\n            wrappedComponent = function wrappedComponent(props) {\n              var shouldUpdate = memoized === sentinel || (compare ? !compare(prevProps, props) : !(0, _enzymeShallowEqual[\"default\"])(prevProps, props));\n\n              if (shouldUpdate) {\n                for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n                  args[_key - 1] = arguments[_key];\n                }\n\n                memoized = Component.apply(void 0, [_objectSpread(_objectSpread({}, Component.defaultProps), props)].concat(args));\n                prevProps = props;\n              }\n\n              return memoized;\n            };\n          }\n\n          (0, _object[\"default\"])(wrappedComponent, Component, {\n            displayName: adapter.displayNameOfNode({\n              type: Component\n            })\n          });\n          lastComponent = Component;\n        }\n\n        return wrappedComponent;\n      }; // Wrap functional components on versions prior to 16.5,\n      // to avoid inadvertently pass a `this` instance to it.\n\n\n      var wrapFunctionalComponent = function wrapFunctionalComponent(Component) {\n        if (is166 && (0, _has[\"default\"])(Component, 'defaultProps')) {\n          if (lastComponent !== Component) {\n            wrappedComponent = (0, _object[\"default\"])( // eslint-disable-next-line new-cap\n            function (props) {\n              for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n                args[_key2 - 1] = arguments[_key2];\n              }\n\n              return Component.apply(void 0, [_objectSpread(_objectSpread({}, Component.defaultProps), props)].concat(args));\n            }, Component, {\n              displayName: adapter.displayNameOfNode({\n                type: Component\n              })\n            });\n            lastComponent = Component;\n          }\n\n          return wrappedComponent;\n        }\n\n        if (is165) {\n          return Component;\n        }\n\n        if (lastComponent !== Component) {\n          wrappedComponent = (0, _object[\"default\"])(function () {\n            return Component.apply(void 0, arguments);\n          }, // eslint-disable-line new-cap\n          Component);\n          lastComponent = Component;\n        }\n\n        return wrappedComponent;\n      };\n\n      var renderElement = function renderElement(elConfig) {\n        for (var _len3 = arguments.length, rest = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n          rest[_key3 - 1] = arguments[_key3];\n        }\n\n        var renderedEl = renderer.render.apply(renderer, [elConfig].concat(rest));\n        var typeIsExisted = !!(renderedEl && renderedEl.type);\n\n        if (is166 && typeIsExisted) {\n          var clonedEl = transformSuspense(renderedEl, elConfig, {\n            suspenseFallback: suspenseFallback\n          });\n          var elementIsChanged = clonedEl.type !== renderedEl.type;\n\n          if (elementIsChanged) {\n            return renderer.render.apply(renderer, [_objectSpread(_objectSpread({}, elConfig), {}, {\n              type: clonedEl.type\n            })].concat(rest));\n          }\n        }\n\n        return renderedEl;\n      };\n\n      return {\n        render: function render(el, unmaskedContext) {\n          var _ref4 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n              _ref4$providerValues = _ref4.providerValues,\n              providerValues = _ref4$providerValues === void 0 ? new Map() : _ref4$providerValues;\n\n          cachedNode = el;\n          /* eslint consistent-return: 0 */\n\n          if (typeof el.type === 'string') {\n            isDOM = true;\n          } else if ((0, _reactIs.isContextProvider)(el)) {\n            providerValues.set(el.type, el.props.value);\n            var MockProvider = (0, _object[\"default\"])(function (props) {\n              return props.children;\n            }, el.type);\n            return (0, _enzymeAdapterUtils.withSetStateAllowed)(function () {\n              return renderElement(_objectSpread(_objectSpread({}, el), {}, {\n                type: MockProvider\n              }));\n            });\n          } else if ((0, _reactIs.isContextConsumer)(el)) {\n            var Provider = adapter.getProviderFromConsumer(el.type);\n            var value = providerValues.has(Provider) ? providerValues.get(Provider) : getProviderDefaultValue(Provider);\n            var MockConsumer = (0, _object[\"default\"])(function (props) {\n              return props.children(value);\n            }, el.type);\n            return (0, _enzymeAdapterUtils.withSetStateAllowed)(function () {\n              return renderElement(_objectSpread(_objectSpread({}, el), {}, {\n                type: MockConsumer\n              }));\n            });\n          } else {\n            isDOM = false;\n            var renderedEl = el;\n\n            if (isLazy(renderedEl)) {\n              throw TypeError('`React.lazy` is not supported by shallow rendering.');\n            }\n\n            renderedEl = transformSuspense(renderedEl, renderedEl, {\n              suspenseFallback: suspenseFallback\n            });\n            var _renderedEl = renderedEl,\n                Component = _renderedEl.type;\n            var context = (0, _enzymeAdapterUtils.getMaskedContext)(Component.contextTypes, unmaskedContext);\n\n            if (isMemo(el.type)) {\n              var _el$type = el.type,\n                  InnerComp = _el$type.type,\n                  compare = _el$type.compare;\n              return (0, _enzymeAdapterUtils.withSetStateAllowed)(function () {\n                return renderElement(_objectSpread(_objectSpread({}, el), {}, {\n                  type: wrapPureComponent(InnerComp, compare)\n                }), context);\n              });\n            }\n\n            var isComponentStateful = isStateful(Component);\n\n            if (!isComponentStateful && typeof Component === 'function') {\n              return (0, _enzymeAdapterUtils.withSetStateAllowed)(function () {\n                return renderElement(_objectSpread(_objectSpread({}, renderedEl), {}, {\n                  type: wrapFunctionalComponent(Component)\n                }), context);\n              });\n            }\n\n            if (isComponentStateful) {\n              if (renderer._instance && el.props === renderer._instance.props && !(0, _enzymeShallowEqual[\"default\"])(context, renderer._instance.context)) {\n                var _spyMethod = (0, _enzymeAdapterUtils.spyMethod)(renderer, '_updateClassComponent', function (originalMethod) {\n                  return function _updateClassComponent() {\n                    var props = renderer._instance.props;\n\n                    var clonedProps = _objectSpread({}, props);\n\n                    renderer._instance.props = clonedProps;\n\n                    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n                      args[_key4] = arguments[_key4];\n                    }\n\n                    var result = originalMethod.apply(renderer, args);\n                    renderer._instance.props = props;\n                    restore();\n                    return result;\n                  };\n                }),\n                    restore = _spyMethod.restore;\n              } // fix react bug; see implementation of `getEmptyStateValue`\n\n\n              var emptyStateValue = getEmptyStateValue();\n\n              if (emptyStateValue) {\n                Object.defineProperty(Component.prototype, 'state', {\n                  configurable: true,\n                  enumerable: true,\n                  get: function get() {\n                    return null;\n                  },\n                  set: function set(value) {\n                    if (value !== emptyStateValue) {\n                      Object.defineProperty(this, 'state', {\n                        configurable: true,\n                        enumerable: true,\n                        value: value,\n                        writable: true\n                      });\n                    }\n\n                    return true;\n                  }\n                });\n              }\n            }\n\n            return (0, _enzymeAdapterUtils.withSetStateAllowed)(function () {\n              return renderElement(renderedEl, context);\n            });\n          }\n        },\n        unmount: function unmount() {\n          renderer.unmount();\n        },\n        getNode: function getNode() {\n          if (isDOM) {\n            return elementToTree(cachedNode);\n          }\n\n          var output = renderer.getRenderOutput();\n          return {\n            nodeType: nodeTypeFromType(cachedNode.type),\n            type: cachedNode.type,\n            props: cachedNode.props,\n            key: (0, _enzymeAdapterUtils.ensureKeyOrUndefined)(cachedNode.key),\n            ref: cachedNode.ref,\n            instance: renderer._instance,\n            rendered: Array.isArray(output) ? flatten(output).map(function (el) {\n              return elementToTree(el);\n            }) : elementToTree(output)\n          };\n        },\n        simulateError: function simulateError(nodeHierarchy, rootNode, error) {\n          (0, _enzymeAdapterUtils.simulateError)(error, renderer._instance, cachedNode, nodeHierarchy.concat(cachedNode), nodeTypeFromType, adapter.displayNameOfNode, is166 ? cachedNode.type : undefined);\n        },\n        simulateEvent: function simulateEvent(node, event) {\n          for (var _len5 = arguments.length, args = new Array(_len5 > 2 ? _len5 - 2 : 0), _key5 = 2; _key5 < _len5; _key5++) {\n            args[_key5 - 2] = arguments[_key5];\n          }\n\n          var handler = node.props[(0, _enzymeAdapterUtils.propFromEvent)(event, eventOptions)];\n\n          if (handler) {\n            (0, _enzymeAdapterUtils.withSetStateAllowed)(function () {\n              // TODO(lmr): create/use synthetic events\n              // TODO(lmr): emulate React's event propagation\n              // ReactDOM.unstable_batchedUpdates(() => {\n              handler.apply(void 0, args); // });\n            });\n          }\n        },\n        batchedUpdates: function batchedUpdates(fn) {\n          return fn(); // return ReactDOM.unstable_batchedUpdates(fn);\n        },\n        checkPropTypes: function checkPropTypes(typeSpecs, values, location, hierarchy) {\n          return (0, _checkPropTypes2[\"default\"])(typeSpecs, values, location, (0, _enzymeAdapterUtils.displayNameOfNode)(cachedNode), function () {\n            return (0, _enzymeAdapterUtils.getComponentStack)(hierarchy.concat([cachedNode]));\n          });\n        }\n      };\n    }\n  }, {\n    key: \"createStringRenderer\",\n    value: function createStringRenderer(options) {\n      if ((0, _has[\"default\"])(options, 'suspenseFallback')) {\n        throw new TypeError('`suspenseFallback` should not be specified in options of string renderer');\n      }\n\n      return {\n        render: function render(el, context) {\n          if (options.context && (el.type.contextTypes || options.childContextTypes)) {\n            var childContextTypes = _objectSpread(_objectSpread({}, el.type.contextTypes || {}), options.childContextTypes);\n\n            var ContextWrapper = (0, _enzymeAdapterUtils.createRenderWrapper)(el, context, childContextTypes);\n            return _server[\"default\"].renderToStaticMarkup( /*#__PURE__*/_react[\"default\"].createElement(ContextWrapper));\n          }\n\n          return _server[\"default\"].renderToStaticMarkup(el);\n        }\n      };\n    } // Provided a bag of options, return an `EnzymeRenderer`. Some options can be implementation\n    // specific, like `attach` etc. for React, but not part of this interface explicitly.\n    // eslint-disable-next-line class-methods-use-this\n\n  }, {\n    key: \"createRenderer\",\n    value: function createRenderer(options) {\n      switch (options.mode) {\n        case _enzyme.EnzymeAdapter.MODES.MOUNT:\n          return this.createMountRenderer(options);\n\n        case _enzyme.EnzymeAdapter.MODES.SHALLOW:\n          return this.createShallowRenderer(options);\n\n        case _enzyme.EnzymeAdapter.MODES.STRING:\n          return this.createStringRenderer(options);\n\n        default:\n          throw new Error(\"Enzyme Internal Error: Unrecognized mode: \".concat(options.mode));\n      }\n    }\n  }, {\n    key: \"wrap\",\n    value: function wrap(element) {\n      return (0, _enzymeAdapterUtils.wrap)(element);\n    } // converts an RSTNode to the corresponding JSX Pragma Element. This will be needed\n    // in order to implement the `Wrapper.mount()` and `Wrapper.shallow()` methods, but should\n    // be pretty straightforward for people to implement.\n    // eslint-disable-next-line class-methods-use-this\n\n  }, {\n    key: \"nodeToElement\",\n    value: function nodeToElement(node) {\n      if (!node || _typeof(node) !== 'object') return null;\n      var type = node.type;\n      return /*#__PURE__*/_react[\"default\"].createElement(unmemoType(type), (0, _enzymeAdapterUtils.propsWithKeysAndRef)(node));\n    } // eslint-disable-next-line class-methods-use-this\n\n  }, {\n    key: \"matchesElementType\",\n    value: function matchesElementType(node, matchingType) {\n      if (!node) {\n        return node;\n      }\n\n      var type = node.type;\n      return unmemoType(type) === unmemoType(matchingType);\n    }\n  }, {\n    key: \"elementToNode\",\n    value: function elementToNode(element) {\n      return elementToTree(element);\n    }\n  }, {\n    key: \"nodeToHostNode\",\n    value: function nodeToHostNode(node) {\n      var supportsArray = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var nodes = _nodeToHostNode(node);\n\n      if (Array.isArray(nodes) && !supportsArray) {\n        return nodes[0];\n      }\n\n      return nodes;\n    }\n  }, {\n    key: \"displayNameOfNode\",\n    value: function displayNameOfNode(node) {\n      if (!node) return null;\n      var type = node.type,\n          $$typeof = node.$$typeof;\n      var adapter = this;\n      var nodeType = type || $$typeof; // newer node types may be undefined, so only test if the nodeType exists\n\n      if (nodeType) {\n        switch (nodeType) {\n          case (is166 ? _reactIs.ConcurrentMode : _reactIs.AsyncMode) || NaN:\n            return is166 ? 'ConcurrentMode' : 'AsyncMode';\n\n          case _reactIs.Fragment || NaN:\n            return 'Fragment';\n\n          case _reactIs.StrictMode || NaN:\n            return 'StrictMode';\n\n          case _reactIs.Profiler || NaN:\n            return 'Profiler';\n\n          case _reactIs.Portal || NaN:\n            return 'Portal';\n\n          case _reactIs.Suspense || NaN:\n            return 'Suspense';\n\n          default:\n        }\n      }\n\n      var $$typeofType = type && type.$$typeof;\n\n      switch ($$typeofType) {\n        case _reactIs.ContextConsumer || NaN:\n          return 'ContextConsumer';\n\n        case _reactIs.ContextProvider || NaN:\n          return 'ContextProvider';\n\n        case _reactIs.Memo || NaN:\n          {\n            var nodeName = (0, _enzymeAdapterUtils.displayNameOfNode)(node);\n            return typeof nodeName === 'string' ? nodeName : \"Memo(\".concat(adapter.displayNameOfNode(type), \")\");\n          }\n\n        case _reactIs.ForwardRef || NaN:\n          {\n            if (type.displayName) {\n              return type.displayName;\n            }\n\n            var name = adapter.displayNameOfNode({\n              type: type.render\n            });\n            return name ? \"ForwardRef(\".concat(name, \")\") : 'ForwardRef';\n          }\n\n        case _reactIs.Lazy || NaN:\n          {\n            return 'lazy';\n          }\n\n        default:\n          return (0, _enzymeAdapterUtils.displayNameOfNode)(node);\n      }\n    }\n  }, {\n    key: \"isValidElement\",\n    value: function isValidElement(element) {\n      return (0, _reactIs.isElement)(element);\n    }\n  }, {\n    key: \"isValidElementType\",\n    value: function isValidElementType(object) {\n      return !!object && (0, _reactIs.isValidElementType)(object);\n    }\n  }, {\n    key: \"isFragment\",\n    value: function isFragment(fragment) {\n      return (0, _Utils.typeOfNode)(fragment) === _reactIs.Fragment;\n    }\n  }, {\n    key: \"isCustomComponent\",\n    value: function isCustomComponent(type) {\n      var fakeElement = makeFakeElement(type);\n      return !!type && (typeof type === 'function' || (0, _reactIs.isForwardRef)(fakeElement) || (0, _reactIs.isContextProvider)(fakeElement) || (0, _reactIs.isContextConsumer)(fakeElement) || (0, _reactIs.isSuspense)(fakeElement));\n    }\n  }, {\n    key: \"isContextConsumer\",\n    value: function isContextConsumer(type) {\n      return !!type && (0, _reactIs.isContextConsumer)(makeFakeElement(type));\n    }\n  }, {\n    key: \"isCustomComponentElement\",\n    value: function isCustomComponentElement(inst) {\n      if (!inst || !this.isValidElement(inst)) {\n        return false;\n      }\n\n      return this.isCustomComponent(inst.type);\n    }\n  }, {\n    key: \"getProviderFromConsumer\",\n    value: function getProviderFromConsumer(Consumer) {\n      // React stores references to the Provider on a Consumer differently across versions.\n      if (Consumer) {\n        var Provider;\n\n        if (Consumer._context) {\n          // check this first, to avoid a deprecation warning\n          Provider = Consumer._context.Provider;\n        } else if (Consumer.Provider) {\n          Provider = Consumer.Provider;\n        }\n\n        if (Provider) {\n          return Provider;\n        }\n      }\n\n      throw new Error('Enzyme Internal Error: can’t figure out how to get Provider from Consumer');\n    }\n  }, {\n    key: \"createElement\",\n    value: function createElement() {\n      return /*#__PURE__*/_react[\"default\"].createElement.apply(_react[\"default\"], arguments);\n    }\n  }, {\n    key: \"wrapWithWrappingComponent\",\n    value: function wrapWithWrappingComponent(node, options) {\n      return {\n        RootFinder: _enzymeAdapterUtils.RootFinder,\n        node: (0, _enzymeAdapterUtils.wrapWithWrappingComponent)(_react[\"default\"].createElement, node, options)\n      };\n    }\n  }]);\n\n  return ReactSixteenAdapter;\n}(_enzyme.EnzymeAdapter);\n\nmodule.exports = ReactSixteenAdapter; //# sourceMappingURL=ReactSixteenAdapter.js.map","map":{"version":3,"sources":["../src/ReactSixteenAdapter.js"],"names":["is164","TestUtils","is165","is166","React","is168","hasShouldComponentUpdateBug","semver","testRendererVersion","FiberTags","array","node","result","stack","i","arr","n","el","Array","type","Portal","Memo","Lazy","isMemo","suspenseFallback","children","renderedEl","fallback","replaceLazyWithFallback","propTypes","defaultProps","contextTypes","contextType","childContextTypes","FakeSuspense","prerenderEl","props","containerInfo","nodeType","key","ref","instance","rendered","elementToTree","vnode","childrenToTree","renderedNodes","flatten","nodeAndSiblingsArray","Suspense","toTree","mapper","item","ReactDOM","isLazy","eventOptions","animation","pointerEvents","auxClick","EmptyState","testRenderer","ShallowRenderer","fn","returnVal","Provider","$$typeof","Element","Component","ReactSixteenAdapter","EnzymeAdapter","lifecycles","enableComponentDidUpdateOnSetState","legacyContextMode","componentDidUpdate","onSetState","getDerivedStateFromProps","getSnapshotBeforeUpdate","setState","skipsComponentDidUpdateOnNullish","getChildContext","calledByRenderer","getDerivedStateFromError","options","attachTo","hydrateIn","wrappingComponentProps","domNode","global","adapter","render","wrapAct","wrapperProps","context","refProp","ReactWrapperComponent","wrappedEl","callback","unmount","getNode","simulateError","isErrorBoundary","elInstance","catchingInstance","catchingType","nodeHierarchy","simulateEvent","mappedEvent","eventFn","batchedUpdates","getWrappingComponentRenderer","inst","getMountWrapperInstance","wrapInvoke","renderer","TypeError","isDOM","cachedNode","lastComponent","wrappedComponent","sentinel","wrapPureComponent","isStateful","compare","memoized","args","shouldUpdate","prevProps","displayName","wrapFunctionalComponent","renderElement","rest","typeIsExisted","clonedEl","transformSuspense","elementIsChanged","providerValues","MockProvider","value","getProviderDefaultValue","MockConsumer","InnerComp","isComponentStateful","restore","clonedProps","originalMethod","emptyStateValue","getEmptyStateValue","Object","configurable","enumerable","get","set","writable","output","nodeTypeFromType","handler","checkPropTypes","hierarchy","ContextWrapper","ReactDOMServer","element","unmemoType","matchingType","supportsArray","nodes","nodeToHostNode","ConcurrentMode","AsyncMode","Fragment","StrictMode","Profiler","$$typeofType","ContextConsumer","ContextProvider","nodeName","ForwardRef","name","object","fragment","fakeElement","makeFakeElement","Consumer","RootFinder","module"],"mappings":"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","sourcesContent":["/* eslint no-use-before-define: 0 */\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n// eslint-disable-next-line import/no-unresolved\nimport ReactDOMServer from 'react-dom/server';\n// eslint-disable-next-line import/no-unresolved\nimport ShallowRenderer from 'react-test-renderer/shallow';\nimport { version as testRendererVersion } from 'react-test-renderer/package.json';\n// eslint-disable-next-line import/no-unresolved\nimport TestUtils from 'react-dom/test-utils';\nimport semver from 'semver';\nimport checkPropTypes from 'prop-types/checkPropTypes';\nimport has from 'has';\nimport {\n  AsyncMode,\n  ConcurrentMode,\n  ContextConsumer,\n  ContextProvider,\n  Element,\n  ForwardRef,\n  Fragment,\n  isContextConsumer,\n  isContextProvider,\n  isElement,\n  isForwardRef,\n  isPortal,\n  isSuspense,\n  isValidElementType,\n  Lazy,\n  Memo,\n  Portal,\n  Profiler,\n  StrictMode,\n  Suspense,\n} from 'react-is';\nimport { EnzymeAdapter } from 'enzyme';\nimport { typeOfNode } from 'enzyme/build/Utils';\nimport shallowEqual from 'enzyme-shallow-equal';\nimport {\n  displayNameOfNode,\n  elementToTree as utilElementToTree,\n  nodeTypeFromType as utilNodeTypeFromType,\n  mapNativeEventNames,\n  propFromEvent,\n  assertDomAvailable,\n  withSetStateAllowed,\n  createRenderWrapper,\n  createMountWrapper,\n  propsWithKeysAndRef,\n  ensureKeyOrUndefined,\n  simulateError,\n  wrap,\n  getMaskedContext,\n  getComponentStack,\n  RootFinder,\n  getNodeFromRootFinder,\n  wrapWithWrappingComponent,\n  getWrappingComponentMountRenderer,\n  compareNodeTypeOf,\n  spyMethod,\n} from 'enzyme-adapter-utils';\nimport findCurrentFiberUsingSlowPath from './findCurrentFiberUsingSlowPath';\nimport detectFiberTags from './detectFiberTags';\n\nconst is164 = !!TestUtils.Simulate.touchStart; // 16.4+\nconst is165 = !!TestUtils.Simulate.auxClick; // 16.5+\nconst is166 = is165 && !React.unstable_AsyncMode; // 16.6+\nconst is168 = is166 && typeof TestUtils.act === 'function';\n\nconst hasShouldComponentUpdateBug = semver.satisfies(testRendererVersion, '< 16.8');\n\n// Lazily populated if DOM is available.\nlet FiberTags = null;\n\nfunction nodeAndSiblingsArray(nodeWithSibling) {\n  const array = [];\n  let node = nodeWithSibling;\n  while (node != null) {\n    array.push(node);\n    node = node.sibling;\n  }\n  return array;\n}\n\nfunction flatten(arr) {\n  const result = [];\n  const stack = [{ i: 0, array: arr }];\n  while (stack.length) {\n    const n = stack.pop();\n    while (n.i < n.array.length) {\n      const el = n.array[n.i];\n      n.i += 1;\n      if (Array.isArray(el)) {\n        stack.push(n);\n        stack.push({ i: 0, array: el });\n        break;\n      }\n      result.push(el);\n    }\n  }\n  return result;\n}\n\nfunction nodeTypeFromType(type) {\n  if (type === Portal) {\n    return 'portal';\n  }\n\n  return utilNodeTypeFromType(type);\n}\n\nfunction isMemo(type) {\n  return compareNodeTypeOf(type, Memo);\n}\n\nfunction isLazy(type) {\n  return compareNodeTypeOf(type, Lazy);\n}\n\nfunction unmemoType(type) {\n  return isMemo(type) ? type.type : type;\n}\n\nfunction transformSuspense(renderedEl, prerenderEl, { suspenseFallback }) {\n  if (!isSuspense(renderedEl)) {\n    return renderedEl;\n  }\n\n  let { children } = renderedEl.props;\n\n  if (suspenseFallback) {\n    const { fallback } = renderedEl.props;\n    children = replaceLazyWithFallback(children, fallback);\n  }\n\n  const {\n    propTypes,\n    defaultProps,\n    contextTypes,\n    contextType,\n    childContextTypes,\n  } = renderedEl.type;\n\n  const FakeSuspense = Object.assign(\n    isStateful(prerenderEl.type)\n      ? class FakeSuspense extends prerenderEl.type {\n        render() {\n          const { type, props } = prerenderEl;\n          return React.createElement(\n            type,\n            { ...props, ...this.props },\n            children,\n          );\n        }\n      }\n      : function FakeSuspense(props) { // eslint-disable-line prefer-arrow-callback\n        return React.createElement(\n          renderedEl.type,\n          { ...renderedEl.props, ...props },\n          children,\n        );\n      },\n    {\n      propTypes,\n      defaultProps,\n      contextTypes,\n      contextType,\n      childContextTypes,\n    },\n  );\n  return React.createElement(FakeSuspense, null, children);\n}\n\nfunction elementToTree(el) {\n  if (!isPortal(el)) {\n    return utilElementToTree(el, elementToTree);\n  }\n\n  const { children, containerInfo } = el;\n  const props = { children, containerInfo };\n\n  return {\n    nodeType: 'portal',\n    type: Portal,\n    props,\n    key: ensureKeyOrUndefined(el.key),\n    ref: el.ref || null,\n    instance: null,\n    rendered: elementToTree(el.children),\n  };\n}\n\nfunction toTree(vnode) {\n  if (vnode == null) {\n    return null;\n  }\n  // TODO(lmr): I'm not really sure I understand whether or not this is what\n  // i should be doing, or if this is a hack for something i'm doing wrong\n  // somewhere else. Should talk to sebastian about this perhaps\n  const node = findCurrentFiberUsingSlowPath(vnode);\n  switch (node.tag) {\n    case FiberTags.HostRoot:\n      return childrenToTree(node.child);\n    case FiberTags.HostPortal: {\n      const {\n        stateNode: { containerInfo },\n        memoizedProps: children,\n      } = node;\n      const props = { containerInfo, children };\n      return {\n        nodeType: 'portal',\n        type: Portal,\n        props,\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: null,\n        rendered: childrenToTree(node.child),\n      };\n    }\n    case FiberTags.ClassComponent:\n      return {\n        nodeType: 'class',\n        type: node.type,\n        props: { ...node.memoizedProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: node.stateNode,\n        rendered: childrenToTree(node.child),\n      };\n    case FiberTags.FunctionalComponent:\n      return {\n        nodeType: 'function',\n        type: node.type,\n        props: { ...node.memoizedProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: null,\n        rendered: childrenToTree(node.child),\n      };\n    case FiberTags.MemoClass:\n      return {\n        nodeType: 'class',\n        type: node.elementType.type,\n        props: { ...node.memoizedProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: node.stateNode,\n        rendered: childrenToTree(node.child.child),\n      };\n    case FiberTags.MemoSFC: {\n      let renderedNodes = flatten(nodeAndSiblingsArray(node.child).map(toTree));\n      if (renderedNodes.length === 0) {\n        renderedNodes = [node.memoizedProps.children];\n      }\n      return {\n        nodeType: 'function',\n        type: node.elementType,\n        props: { ...node.memoizedProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: null,\n        rendered: renderedNodes,\n      };\n    }\n    case FiberTags.HostComponent: {\n      let renderedNodes = flatten(nodeAndSiblingsArray(node.child).map(toTree));\n      if (renderedNodes.length === 0) {\n        renderedNodes = [node.memoizedProps.children];\n      }\n      return {\n        nodeType: 'host',\n        type: node.type,\n        props: { ...node.memoizedProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: node.stateNode,\n        rendered: renderedNodes,\n      };\n    }\n    case FiberTags.HostText:\n      return node.memoizedProps;\n    case FiberTags.Fragment:\n    case FiberTags.Mode:\n    case FiberTags.ContextProvider:\n    case FiberTags.ContextConsumer:\n      return childrenToTree(node.child);\n    case FiberTags.Profiler:\n    case FiberTags.ForwardRef: {\n      return {\n        nodeType: 'function',\n        type: node.type,\n        props: { ...node.pendingProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: null,\n        rendered: childrenToTree(node.child),\n      };\n    }\n    case FiberTags.Suspense: {\n      return {\n        nodeType: 'function',\n        type: Suspense,\n        props: { ...node.memoizedProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: null,\n        rendered: childrenToTree(node.child),\n      };\n    }\n    case FiberTags.Lazy:\n      return childrenToTree(node.child);\n    default:\n      throw new Error(`Enzyme Internal Error: unknown node with tag ${node.tag}`);\n  }\n}\n\nfunction childrenToTree(node) {\n  if (!node) {\n    return null;\n  }\n  const children = nodeAndSiblingsArray(node);\n  if (children.length === 0) {\n    return null;\n  }\n  if (children.length === 1) {\n    return toTree(children[0]);\n  }\n  return flatten(children.map(toTree));\n}\n\nfunction nodeToHostNode(_node) {\n  // NOTE(lmr): node could be a function component\n  // which wont have an instance prop, but we can get the\n  // host node associated with its return value at that point.\n  // Although this breaks down if the return value is an array,\n  // as is possible with React 16.\n  let node = _node;\n  while (node && !Array.isArray(node) && node.instance === null) {\n    node = node.rendered;\n  }\n  // if the SFC returned null effectively, there is no host node.\n  if (!node) {\n    return null;\n  }\n\n  const mapper = (item) => {\n    if (item && item.instance) return ReactDOM.findDOMNode(item.instance);\n    return null;\n  };\n  if (Array.isArray(node)) {\n    return node.map(mapper);\n  }\n  if (Array.isArray(node.rendered) && node.nodeType === 'class') {\n    return node.rendered.map(mapper);\n  }\n  return mapper(node);\n}\n\nfunction replaceLazyWithFallback(node, fallback) {\n  if (!node) {\n    return null;\n  }\n  if (Array.isArray(node)) {\n    return node.map((el) => replaceLazyWithFallback(el, fallback));\n  }\n  if (isLazy(node.type)) {\n    return fallback;\n  }\n  return {\n    ...node,\n    props: {\n      ...node.props,\n      children: replaceLazyWithFallback(node.props.children, fallback),\n    },\n  };\n}\n\nconst eventOptions = {\n  animation: true,\n  pointerEvents: is164,\n  auxClick: is165,\n};\n\nfunction getEmptyStateValue() {\n  // this handles a bug in React 16.0 - 16.2\n  // see https://github.com/facebook/react/commit/39be83565c65f9c522150e52375167568a2a1459\n  // also see https://github.com/facebook/react/pull/11965\n\n  // eslint-disable-next-line react/prefer-stateless-function\n  class EmptyState extends React.Component {\n    render() {\n      return null;\n    }\n  }\n  const testRenderer = new ShallowRenderer();\n  testRenderer.render(React.createElement(EmptyState));\n  return testRenderer._instance.state;\n}\n\nfunction wrapAct(fn) {\n  if (!is168) {\n    return fn();\n  }\n  let returnVal;\n  TestUtils.act(() => { returnVal = fn(); });\n  return returnVal;\n}\n\nfunction getProviderDefaultValue(Provider) {\n  // React stores references to the Provider's defaultValue differently across versions.\n  if ('_defaultValue' in Provider._context) {\n    return Provider._context._defaultValue;\n  }\n  if ('_currentValue' in Provider._context) {\n    return Provider._context._currentValue;\n  }\n  throw new Error('Enzyme Internal Error: can’t figure out how to get Provider’s default value');\n}\n\nfunction makeFakeElement(type) {\n  return { $$typeof: Element, type };\n}\n\nfunction isStateful(Component) {\n  return Component.prototype && (\n    Component.prototype.isReactComponent\n    || Array.isArray(Component.__reactAutoBindPairs) // fallback for createClass components\n  );\n}\n\nclass ReactSixteenAdapter extends EnzymeAdapter {\n  constructor() {\n    super();\n    const { lifecycles } = this.options;\n    this.options = {\n      ...this.options,\n      enableComponentDidUpdateOnSetState: true, // TODO: remove, semver-major\n      legacyContextMode: 'parent',\n      lifecycles: {\n        ...lifecycles,\n        componentDidUpdate: {\n          onSetState: true,\n        },\n        getDerivedStateFromProps: {\n          hasShouldComponentUpdateBug,\n        },\n        getSnapshotBeforeUpdate: true,\n        setState: {\n          skipsComponentDidUpdateOnNullish: true,\n        },\n        getChildContext: {\n          calledByRenderer: false,\n        },\n        getDerivedStateFromError: is166,\n      },\n    };\n  }\n\n  createMountRenderer(options) {\n    assertDomAvailable('mount');\n    if (has(options, 'suspenseFallback')) {\n      throw new TypeError('`suspenseFallback` is not supported by the `mount` renderer');\n    }\n    if (FiberTags === null) {\n      // Requires DOM.\n      FiberTags = detectFiberTags();\n    }\n    const { attachTo, hydrateIn, wrappingComponentProps } = options;\n    const domNode = hydrateIn || attachTo || global.document.createElement('div');\n    let instance = null;\n    const adapter = this;\n    return {\n      render(el, context, callback) {\n        return wrapAct(() => {\n          if (instance === null) {\n            const { type, props, ref } = el;\n            const wrapperProps = {\n              Component: type,\n              props,\n              wrappingComponentProps,\n              context,\n              ...(ref && { refProp: ref }),\n            };\n            const ReactWrapperComponent = createMountWrapper(el, { ...options, adapter });\n            const wrappedEl = React.createElement(ReactWrapperComponent, wrapperProps);\n            instance = hydrateIn\n              ? ReactDOM.hydrate(wrappedEl, domNode)\n              : ReactDOM.render(wrappedEl, domNode);\n            if (typeof callback === 'function') {\n              callback();\n            }\n          } else {\n            instance.setChildProps(el.props, context, callback);\n          }\n        });\n      },\n      unmount() {\n        ReactDOM.unmountComponentAtNode(domNode);\n        instance = null;\n      },\n      getNode() {\n        if (!instance) {\n          return null;\n        }\n        return getNodeFromRootFinder(\n          adapter.isCustomComponent,\n          toTree(instance._reactInternalFiber),\n          options,\n        );\n      },\n      simulateError(nodeHierarchy, rootNode, error) {\n        const isErrorBoundary = ({ instance: elInstance, type }) => {\n          if (is166 && type && type.getDerivedStateFromError) {\n            return true;\n          }\n          return elInstance && elInstance.componentDidCatch;\n        };\n\n        const {\n          instance: catchingInstance,\n          type: catchingType,\n        } = nodeHierarchy.find(isErrorBoundary) || {};\n\n        simulateError(\n          error,\n          catchingInstance,\n          rootNode,\n          nodeHierarchy,\n          nodeTypeFromType,\n          adapter.displayNameOfNode,\n          is166 ? catchingType : undefined,\n        );\n      },\n      simulateEvent(node, event, mock) {\n        const mappedEvent = mapNativeEventNames(event, eventOptions);\n        const eventFn = TestUtils.Simulate[mappedEvent];\n        if (!eventFn) {\n          throw new TypeError(`ReactWrapper::simulate() event '${event}' does not exist`);\n        }\n        wrapAct(() => {\n          eventFn(adapter.nodeToHostNode(node), mock);\n        });\n      },\n      batchedUpdates(fn) {\n        return fn();\n        // return ReactDOM.unstable_batchedUpdates(fn);\n      },\n      getWrappingComponentRenderer() {\n        return {\n          ...this,\n          ...getWrappingComponentMountRenderer({\n            toTree: (inst) => toTree(inst._reactInternalFiber),\n            getMountWrapperInstance: () => instance,\n          }),\n        };\n      },\n      ...(is168 && { wrapInvoke: wrapAct }),\n    };\n  }\n\n  createShallowRenderer(options = {}) {\n    const adapter = this;\n    const renderer = new ShallowRenderer();\n    const { suspenseFallback } = options;\n    if (typeof suspenseFallback !== 'undefined' && typeof suspenseFallback !== 'boolean') {\n      throw TypeError('`options.suspenseFallback` should be boolean or undefined');\n    }\n    let isDOM = false;\n    let cachedNode = null;\n\n    let lastComponent = null;\n    let wrappedComponent = null;\n    const sentinel = {};\n\n    // wrap memo components with a PureComponent, or a class component with sCU\n    const wrapPureComponent = (Component, compare) => {\n      if (!is166) {\n        throw new RangeError('this function should not be called in React < 16.6. Please report this!');\n      }\n      if (lastComponent !== Component) {\n        if (isStateful(Component)) {\n          wrappedComponent = class extends Component {}; // eslint-disable-line react/prefer-stateless-function\n          if (compare) {\n            wrappedComponent.prototype.shouldComponentUpdate = (nextProps) => !compare(this.props, nextProps);\n          } else {\n            wrappedComponent.prototype.isPureReactComponent = true;\n          }\n        } else {\n          let memoized = sentinel;\n          let prevProps;\n          wrappedComponent = function (props, ...args) {\n            const shouldUpdate = memoized === sentinel || (compare\n              ? !compare(prevProps, props)\n              : !shallowEqual(prevProps, props)\n            );\n            if (shouldUpdate) {\n              memoized = Component({ ...Component.defaultProps, ...props }, ...args);\n              prevProps = props;\n            }\n            return memoized;\n          };\n        }\n        Object.assign(\n          wrappedComponent,\n          Component,\n          { displayName: adapter.displayNameOfNode({ type: Component }) },\n        );\n        lastComponent = Component;\n      }\n      return wrappedComponent;\n    };\n\n    // Wrap functional components on versions prior to 16.5,\n    // to avoid inadvertently pass a `this` instance to it.\n    const wrapFunctionalComponent = (Component) => {\n      if (is166 && has(Component, 'defaultProps')) {\n        if (lastComponent !== Component) {\n          wrappedComponent = Object.assign(\n            // eslint-disable-next-line new-cap\n            (props, ...args) => Component({ ...Component.defaultProps, ...props }, ...args),\n            Component,\n            { displayName: adapter.displayNameOfNode({ type: Component }) },\n          );\n          lastComponent = Component;\n        }\n        return wrappedComponent;\n      }\n      if (is165) {\n        return Component;\n      }\n\n      if (lastComponent !== Component) {\n        wrappedComponent = Object.assign(\n          (...args) => Component(...args), // eslint-disable-line new-cap\n          Component,\n        );\n        lastComponent = Component;\n      }\n      return wrappedComponent;\n    };\n\n    const renderElement = (elConfig, ...rest) => {\n      const renderedEl = renderer.render(elConfig, ...rest);\n\n      const typeIsExisted = !!(renderedEl && renderedEl.type);\n      if (is166 && typeIsExisted) {\n        const clonedEl = transformSuspense(renderedEl, elConfig, { suspenseFallback });\n\n        const elementIsChanged = clonedEl.type !== renderedEl.type;\n        if (elementIsChanged) {\n          return renderer.render({ ...elConfig, type: clonedEl.type }, ...rest);\n        }\n      }\n\n      return renderedEl;\n    };\n\n    return {\n      render(el, unmaskedContext, {\n        providerValues = new Map(),\n      } = {}) {\n        cachedNode = el;\n        /* eslint consistent-return: 0 */\n        if (typeof el.type === 'string') {\n          isDOM = true;\n        } else if (isContextProvider(el)) {\n          providerValues.set(el.type, el.props.value);\n          const MockProvider = Object.assign(\n            (props) => props.children,\n            el.type,\n          );\n          return withSetStateAllowed(() => renderElement({ ...el, type: MockProvider }));\n        } else if (isContextConsumer(el)) {\n          const Provider = adapter.getProviderFromConsumer(el.type);\n          const value = providerValues.has(Provider)\n            ? providerValues.get(Provider)\n            : getProviderDefaultValue(Provider);\n          const MockConsumer = Object.assign(\n            (props) => props.children(value),\n            el.type,\n          );\n          return withSetStateAllowed(() => renderElement({ ...el, type: MockConsumer }));\n        } else {\n          isDOM = false;\n          let renderedEl = el;\n          if (isLazy(renderedEl)) {\n            throw TypeError('`React.lazy` is not supported by shallow rendering.');\n          }\n\n          renderedEl = transformSuspense(renderedEl, renderedEl, { suspenseFallback });\n          const { type: Component } = renderedEl;\n\n          const context = getMaskedContext(Component.contextTypes, unmaskedContext);\n\n          if (isMemo(el.type)) {\n            const { type: InnerComp, compare } = el.type;\n\n            return withSetStateAllowed(() => renderElement(\n              { ...el, type: wrapPureComponent(InnerComp, compare) },\n              context,\n            ));\n          }\n\n          const isComponentStateful = isStateful(Component);\n\n          if (!isComponentStateful && typeof Component === 'function') {\n            return withSetStateAllowed(() => renderElement(\n              { ...renderedEl, type: wrapFunctionalComponent(Component) },\n              context,\n            ));\n          }\n\n          if (isComponentStateful) {\n            if (\n              renderer._instance\n              && el.props === renderer._instance.props\n              && !shallowEqual(context, renderer._instance.context)\n            ) {\n              const { restore } = spyMethod(\n                renderer,\n                '_updateClassComponent',\n                (originalMethod) => function _updateClassComponent(...args) {\n                  const { props } = renderer._instance;\n                  const clonedProps = { ...props };\n                  renderer._instance.props = clonedProps;\n\n                  const result = originalMethod.apply(renderer, args);\n\n                  renderer._instance.props = props;\n                  restore();\n\n                  return result;\n                },\n              );\n            }\n\n            // fix react bug; see implementation of `getEmptyStateValue`\n            const emptyStateValue = getEmptyStateValue();\n            if (emptyStateValue) {\n              Object.defineProperty(Component.prototype, 'state', {\n                configurable: true,\n                enumerable: true,\n                get() {\n                  return null;\n                },\n                set(value) {\n                  if (value !== emptyStateValue) {\n                    Object.defineProperty(this, 'state', {\n                      configurable: true,\n                      enumerable: true,\n                      value,\n                      writable: true,\n                    });\n                  }\n                  return true;\n                },\n              });\n            }\n          }\n          return withSetStateAllowed(() => renderElement(renderedEl, context));\n        }\n      },\n      unmount() {\n        renderer.unmount();\n      },\n      getNode() {\n        if (isDOM) {\n          return elementToTree(cachedNode);\n        }\n        const output = renderer.getRenderOutput();\n        return {\n          nodeType: nodeTypeFromType(cachedNode.type),\n          type: cachedNode.type,\n          props: cachedNode.props,\n          key: ensureKeyOrUndefined(cachedNode.key),\n          ref: cachedNode.ref,\n          instance: renderer._instance,\n          rendered: Array.isArray(output)\n            ? flatten(output).map((el) => elementToTree(el))\n            : elementToTree(output),\n        };\n      },\n      simulateError(nodeHierarchy, rootNode, error) {\n        simulateError(\n          error,\n          renderer._instance,\n          cachedNode,\n          nodeHierarchy.concat(cachedNode),\n          nodeTypeFromType,\n          adapter.displayNameOfNode,\n          is166 ? cachedNode.type : undefined,\n        );\n      },\n      simulateEvent(node, event, ...args) {\n        const handler = node.props[propFromEvent(event, eventOptions)];\n        if (handler) {\n          withSetStateAllowed(() => {\n            // TODO(lmr): create/use synthetic events\n            // TODO(lmr): emulate React's event propagation\n            // ReactDOM.unstable_batchedUpdates(() => {\n            handler(...args);\n            // });\n          });\n        }\n      },\n      batchedUpdates(fn) {\n        return fn();\n        // return ReactDOM.unstable_batchedUpdates(fn);\n      },\n      checkPropTypes(typeSpecs, values, location, hierarchy) {\n        return checkPropTypes(\n          typeSpecs,\n          values,\n          location,\n          displayNameOfNode(cachedNode),\n          () => getComponentStack(hierarchy.concat([cachedNode])),\n        );\n      },\n    };\n  }\n\n  createStringRenderer(options) {\n    if (has(options, 'suspenseFallback')) {\n      throw new TypeError('`suspenseFallback` should not be specified in options of string renderer');\n    }\n    return {\n      render(el, context) {\n        if (options.context && (el.type.contextTypes || options.childContextTypes)) {\n          const childContextTypes = {\n            ...(el.type.contextTypes || {}),\n            ...options.childContextTypes,\n          };\n          const ContextWrapper = createRenderWrapper(el, context, childContextTypes);\n          return ReactDOMServer.renderToStaticMarkup(React.createElement(ContextWrapper));\n        }\n        return ReactDOMServer.renderToStaticMarkup(el);\n      },\n    };\n  }\n\n  // Provided a bag of options, return an `EnzymeRenderer`. Some options can be implementation\n  // specific, like `attach` etc. for React, but not part of this interface explicitly.\n  // eslint-disable-next-line class-methods-use-this\n  createRenderer(options) {\n    switch (options.mode) {\n      case EnzymeAdapter.MODES.MOUNT: return this.createMountRenderer(options);\n      case EnzymeAdapter.MODES.SHALLOW: return this.createShallowRenderer(options);\n      case EnzymeAdapter.MODES.STRING: return this.createStringRenderer(options);\n      default:\n        throw new Error(`Enzyme Internal Error: Unrecognized mode: ${options.mode}`);\n    }\n  }\n\n  wrap(element) {\n    return wrap(element);\n  }\n\n  // converts an RSTNode to the corresponding JSX Pragma Element. This will be needed\n  // in order to implement the `Wrapper.mount()` and `Wrapper.shallow()` methods, but should\n  // be pretty straightforward for people to implement.\n  // eslint-disable-next-line class-methods-use-this\n  nodeToElement(node) {\n    if (!node || typeof node !== 'object') return null;\n    const { type } = node;\n    return React.createElement(unmemoType(type), propsWithKeysAndRef(node));\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  matchesElementType(node, matchingType) {\n    if (!node) {\n      return node;\n    }\n    const { type } = node;\n    return unmemoType(type) === unmemoType(matchingType);\n  }\n\n  elementToNode(element) {\n    return elementToTree(element);\n  }\n\n  nodeToHostNode(node, supportsArray = false) {\n    const nodes = nodeToHostNode(node);\n    if (Array.isArray(nodes) && !supportsArray) {\n      return nodes[0];\n    }\n    return nodes;\n  }\n\n  displayNameOfNode(node) {\n    if (!node) return null;\n    const { type, $$typeof } = node;\n    const adapter = this;\n\n    const nodeType = type || $$typeof;\n\n    // newer node types may be undefined, so only test if the nodeType exists\n    if (nodeType) {\n      switch (nodeType) {\n        case (is166 ? ConcurrentMode : AsyncMode) || NaN: return is166 ? 'ConcurrentMode' : 'AsyncMode';\n        case Fragment || NaN: return 'Fragment';\n        case StrictMode || NaN: return 'StrictMode';\n        case Profiler || NaN: return 'Profiler';\n        case Portal || NaN: return 'Portal';\n        case Suspense || NaN: return 'Suspense';\n        default:\n      }\n    }\n\n    const $$typeofType = type && type.$$typeof;\n\n    switch ($$typeofType) {\n      case ContextConsumer || NaN: return 'ContextConsumer';\n      case ContextProvider || NaN: return 'ContextProvider';\n      case Memo || NaN: {\n        const nodeName = displayNameOfNode(node);\n        return typeof nodeName === 'string' ? nodeName : `Memo(${adapter.displayNameOfNode(type)})`;\n      }\n      case ForwardRef || NaN: {\n        if (type.displayName) {\n          return type.displayName;\n        }\n        const name = adapter.displayNameOfNode({ type: type.render });\n        return name ? `ForwardRef(${name})` : 'ForwardRef';\n      }\n      case Lazy || NaN: {\n        return 'lazy';\n      }\n      default: return displayNameOfNode(node);\n    }\n  }\n\n  isValidElement(element) {\n    return isElement(element);\n  }\n\n  isValidElementType(object) {\n    return !!object && isValidElementType(object);\n  }\n\n  isFragment(fragment) {\n    return typeOfNode(fragment) === Fragment;\n  }\n\n  isCustomComponent(type) {\n    const fakeElement = makeFakeElement(type);\n    return !!type && (\n      typeof type === 'function'\n      || isForwardRef(fakeElement)\n      || isContextProvider(fakeElement)\n      || isContextConsumer(fakeElement)\n      || isSuspense(fakeElement)\n    );\n  }\n\n  isContextConsumer(type) {\n    return !!type && isContextConsumer(makeFakeElement(type));\n  }\n\n  isCustomComponentElement(inst) {\n    if (!inst || !this.isValidElement(inst)) {\n      return false;\n    }\n    return this.isCustomComponent(inst.type);\n  }\n\n  getProviderFromConsumer(Consumer) {\n    // React stores references to the Provider on a Consumer differently across versions.\n    if (Consumer) {\n      let Provider;\n      if (Consumer._context) { // check this first, to avoid a deprecation warning\n        ({ Provider } = Consumer._context);\n      } else if (Consumer.Provider) {\n        ({ Provider } = Consumer);\n      }\n      if (Provider) {\n        return Provider;\n      }\n    }\n    throw new Error('Enzyme Internal Error: can’t figure out how to get Provider from Consumer');\n  }\n\n  createElement(...args) {\n    return React.createElement(...args);\n  }\n\n  wrapWithWrappingComponent(node, options) {\n    return {\n      RootFinder,\n      node: wrapWithWrappingComponent(React.createElement, node, options),\n    };\n  }\n}\n\nmodule.exports = ReactSixteenAdapter;\n"]},"metadata":{},"sourceType":"script"}